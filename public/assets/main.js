!function(){var e={225:function(e,t,r){"use strict";r.r(t),r("793");let s={DB_NAME:"LunarLettersDB",DB_VERSION:1,db:null,async open(){return this.db?this.db:new Promise((e,t)=>{let r=indexedDB.open(this.DB_NAME,this.DB_VERSION);r.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains("bookmarks")&&t.createObjectStore("bookmarks",{keyPath:"slug"}).createIndex("addedAt","addedAt",{unique:!1}),!t.objectStoreNames.contains("history")){let e=t.createObjectStore("history",{keyPath:"id"});e.createIndex("readAt","readAt",{unique:!1}),e.createIndex("seriesSlug","seriesSlug",{unique:!1})}!t.objectStoreNames.contains("progress")&&t.createObjectStore("progress",{keyPath:"seriesId"})},r.onsuccess=t=>{this.db=t.target.result,e(this.db)},r.onerror=e=>t(e.target.error)})},async toggleBookmark(e){await this.open();let t=this.db.transaction("bookmarks","readwrite").objectStore("bookmarks");return await new Promise(r=>{let s=t.get(e.slug);s.onsuccess=()=>r(s.result)})?(t.delete(e.slug),!1):(t.put({slug:e.slug,title:e.title,author:e.author,cover:e.cover,addedAt:Date.now()}),!0)},async isBookmarked(e){return await this.open(),new Promise(t=>{let r=this.db.transaction("bookmarks","readonly").objectStore("bookmarks").get(e);r.onsuccess=()=>t(!!r.result)})},async addToHistory(e){await this.open(),this.db.transaction("history","readwrite").objectStore("history").put({id:e.id,title:e.title,seriesTitle:e.seriesTitle,seriesSlug:e.seriesSlug,chapterNum:e.chapterNum,readAt:Date.now()})}};window.LibDB=s,document.addEventListener("DOMContentLoaded",async()=>{try{await s.open()}catch(e){console.error("Failed to open IndexedDB:",e)}let e=document.getElementById("bookmark-btn");if(e){let r=e.dataset.slug,o=e.dataset.title,a=e.dataset.author,n=e.dataset.cover;t(e,await s.isBookmarked(r)),e.addEventListener("click",async()=>{t(e,await s.toggleBookmark({slug:r,title:o,author:a,cover:n}))})}function t(e,t){t?(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="currentColor"><path d="M200-120v-640q0-33 23.5-56.5T280-840h400q33 0 56.5 23.5T760-760v640L480-240 200-120Z"/></svg>',e.classList.add("active")):(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="currentColor"><path d="M200-120v-640q0-33 23.5-56.5T280-840h400q33 0 56.5 23.5T760-760v640L480-240 200-120Zm80-122 200-86 200 86v-518H280v518Zm0-518h400-400Z"/></svg>',e.classList.remove("active"))}let r=document.getElementById("theme-toggle"),o=document.getElementById("reader-theme-toggle"),a=()=>{let e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)};r&&r.addEventListener("click",a),o&&o.addEventListener("click",a);let n=document.querySelectorAll(".pill[data-filter]"),i=document.getElementById("novel-list");n.length&&i&&n.forEach(e=>{e.addEventListener("click",()=>{n.forEach(e=>e.classList.remove("active")),e.classList.add("active");let t=e.dataset.filter;i.querySelectorAll(".novel-row").forEach(e=>{if("all"===t)e.style.display="";else if("ongoing"===t){let t=(e.dataset.status||"").toLowerCase(),r=t.includes("ongoing")||t.includes("publishing");e.style.display=r?"":"none"}else{let r=(e.dataset.status||"").toLowerCase();e.style.display=r.includes(t)?"":"none"}})})});let l=document.getElementById("app-header");if(l){let e=0,t=!1;window.addEventListener("scroll",()=>{!t&&(requestAnimationFrame(()=>{let r=window.scrollY;r<=10?l.style.transform="":(r>e&&r>80?l.style.transform="translateY(-100%)":l.style.transform="translateY(0)",l.style.transition="transform 0.3s ease"),e=r,t=!1}),t=!0)},{passive:!0})}let c=document.getElementById("top-bar"),d=document.getElementById("bottom-bar");if(c&&d){let e,t=!0,r=()=>{t=!0,c.classList.add("visible"),d.classList.add("visible"),clearTimeout(e)},s=()=>{t=!1,c.classList.remove("visible"),d.classList.remove("visible")},o=()=>{clearTimeout(e),e=setTimeout(s,3e3)};window.addEventListener("scroll",()=>{let e=window.scrollY<100,t=window.innerHeight+window.scrollY>=document.body.offsetHeight-100;(e||t)&&r()},{passive:!0}),window.addEventListener("click",e=>{!(e.target.closest("button")||e.target.closest("a"))&&(t?s():(r(),o()))}),c.addEventListener("mouseenter",()=>clearTimeout(e)),d.addEventListener("mouseenter",()=>clearTimeout(e)),c.addEventListener("mouseleave",o),d.addEventListener("mouseleave",o),r(),o()}let u=document.querySelectorAll(".series-tab");u.length&&u.forEach(e=>{e.addEventListener("click",()=>{u.forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab-panel").forEach(e=>e.classList.remove("active")),e.classList.add("active");let t=document.getElementById("panel-"+e.dataset.tab);t&&t.classList.add("active")})});let m=document.getElementById("start-reading-btn");m&&m.addEventListener("click",()=>{let e=document.querySelector('.series-tab[data-tab="chapters"]');e&&e.click()})})},793:function(e){}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}r.m=e,r.k=function(e){return""+e+".css"},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},!function(){r.g.importScripts&&(e=r.g.location+"");var e,t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length){for(var o=s.length-1;o>-1&&!e;)e=s[o--].src}}if(!e)throw Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),r("225")}();
//# sourceMappingURL=main.js.map